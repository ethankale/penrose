<html>

<head>

</head>

<body>

  <canvas id="tiles" height="500" width="600">
  
  </canvas>
  
  <script type="text/javascript">
    var PHI = 0.5 + Math.sqrt(5 / 4);
    var canvas = document.getElementById("tiles").getContext("2d");
    
    var len    = 100
    var startX = 200
    var startY = 200
    
    // There are ten legitimate angles for shapes - various multiples of 36
    var angles = [];
    for (var i=0; i<10; i++) {
        angles[i] = i * 36;
    }
    
    // Sine and cosine functions in javascript accept radians rather than degrees.
    function degToRad(degrees) {
        return degrees * (Math.PI / 180)
    }
    
    function drawShape(shape, x, y, deg, len, fillCol, strokeCol) {
        // Template for drawing kites & darts.  Specify the x,y coords of the endpoint
        //  and the rotation; optionally the length of a side and fill & stroke color.
        
        // Default values
        x = typeof x !== 'undefined' ? x : 0;
        y = typeof y !== 'undefined' ? y : 0;
        deg = typeof deg !== 'undefined' ? deg : 0;
        len = typeof len !== 'undefined' ? len : 50;
        shortLen = (len / PHI)
        fillCol = typeof fillCol !== 'undefined' ? fillCol : '#f00';
        strokeCol = typeof strokeCol !== 'undefined' ? strokeCol : 'blue';
        
        angle     = deg + 36
        antiAngle = deg - 36
        angle90   = deg + 90
        angle108  = deg + 108
        angle144  = deg + 144
        
        canvas.moveTo(x, y);
        canvas.beginPath();
        
        if (shape == "dart") {
            canvas.lineTo(x + (len * Math.cos(degToRad(angle))),     y + (len * Math.sin(degToRad(angle))));
            canvas.lineTo(x + (len * Math.cos(degToRad(deg))),       y + (len * Math.sin(degToRad(deg))));
            canvas.lineTo(x + (len * Math.cos(degToRad(antiAngle))), y + (len * Math.sin(degToRad(antiAngle))));
            canvas.lineTo(x, y)
        } else if (shape == "kite") {
            var x1, y1, x2, y2, x3, y3;
            x1 = x + (len * Math.cos(degToRad(angle)));
            y1 = y - (len * Math.sin(degToRad(angle)));
            x2 = x1 - (len * Math.sin(degToRad(54 + deg)));
            y2 = y1 - (len * Math.cos(degToRad(54 + deg)));
            x3 = x2 + (shortLen * Math.sin(degToRad(18 + deg)));
            y3 = y2 + (shortLen * Math.cos(degToRad(18 + deg)));
            
            canvas.lineTo(x1, y1);
            canvas.lineTo(x2, y2);
            canvas.lineTo(x3, y3);
            canvas.lineTo(x, y)
        }
        
        canvas.closePath();
        canvas.fillStyle = fillCol;
        canvas.fill();
        canvas.strokeStyle = strokeCol;
        canvas.stroke();
        
        // Draw the curvy lines
        
        // Calculating lengths is confusing.  Here's a cheat sheet:
        //
        // len = z(1 + PHI)
        // 
        // Solving for x will make calculating lengths a lot easier (especially for the radius of the arcs)
        // The variable z is the radius of the 144 degree arc for the dart, and the 216 degree arc for the kite
        // Basically, sub for the radii of length 1 in the diagrams here: http://math.uchicago.edu/~mann/penrose.pdf
        // Therefore:
        z = 1 / ((1 + PHI) / len)
        
        if (shape == "dart") {
            canvas.beginPath();
            canvas.strokeStyle = "yellow";
            canvas.arc(x, y, z * PHI, -degToRad(angle), degToRad(angle));
            canvas.stroke();
            
            canvas.beginPath();
            canvas.strokeStyle = "purple";
            canvas.arc(x + len, y, z, degToRad(angle108), -degToRad(angle108));
            canvas.stroke();
            
        }
        
        if (shape == "kite") {
            canvas.beginPath();
            canvas.strokeStyle = "purple";
            canvas.arc(x + ((len * Math.cos(degToRad(angle))) - ((1/PHI) * len)), 
                       y - (len * Math.sin(degToRad(angle))), 
                       z / PHI, -degToRad(angle108), 
                       degToRad(angle108)
            );
            canvas.stroke();
            
            canvas.beginPath();
            canvas.strokeStyle = "yellow";
            canvas.arc(x + (len * Math.cos(degToRad(angle))), 
                       y - (len * Math.sin(degToRad(angle)), 
                       z, 
                       degToRad(angle144), -degToRad(angle144))
            );
            canvas.stroke();
            
        }
        //canvas.restore();
    }
    
    theHeight = startY - (2 * (len * Math.sin(degToRad(36))))
    //drawShape("dart", x = startX, y = startY, deg = angles[0],  len = len, fillCol = "lightgray");
    drawShape("kite", x = startX, y = startY, deg = angles[1],  len = len, fillCol = "lightgray");
    //drawShape("dart", x = startX, y = startY, deg = angles[2], len = len, fillCol = "lightgray");
    //drawShape("kite", x = startX, y = theHeight, deg = angles[2],  len = len, fillCol = "lightgray");
    

  
  </script>
  
</body>

</html>